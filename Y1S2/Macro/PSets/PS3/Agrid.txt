clear
r=0.02;
yvec=[0.05,0.5];
min=0.0001;
amax=2;
k=20;
gamma=(1+r)^(1/(k-1));
step1=(yvec(1)-min)*(gamma-1)/r;
n=floor(1+log(amax*(gamma-1)/step1+1)/log(gamma));
f=@(x)step1*(gamma.^(x-1)-1)/(gamma-1);
agrid=f(1:n)



agrid =

  Columns 1 through 11

         0    0.0026    0.0052    0.0078    0.0104    0.0130    0.0157    0.0183    0.0209    0.0235    0.0261

  Columns 12 through 22

    0.0288    0.0314    0.0340    0.0367    0.0393    0.0420    0.0446    0.0472    0.0499    0.0526    0.0552

  Columns 23 through 33

    0.0579    0.0605    0.0632    0.0659    0.0685    0.0712    0.0739    0.0766    0.0792    0.0819    0.0846

  Columns 34 through 44

    0.0873    0.0900    0.0927    0.0954    0.0981    0.1008    0.1035    0.1062    0.1089    0.1116    0.1144

  Columns 45 through 55

    0.1171    0.1198    0.1225    0.1253    0.1280    0.1307    0.1335    0.1362    0.1390    0.1417    0.1444

  Columns 56 through 66

    0.1472    0.1500    0.1527    0.1555    0.1582    0.1610    0.1638    0.1665    0.1693    0.1721    0.1749

  Columns 67 through 77

    0.1777    0.1805    0.1832    0.1860    0.1888    0.1916    0.1944    0.1972    0.2000    0.2029    0.2057

  Columns 78 through 88

    0.2085    0.2113    0.2141    0.2170    0.2198    0.2226    0.2254    0.2283    0.2311    0.2340    0.2368

  Columns 89 through 99

    0.2397    0.2425    0.2454    0.2482    0.2511    0.2539    0.2568    0.2597    0.2626    0.2654    0.2683

  Columns 100 through 110

    0.2712    0.2741    0.2770    0.2799    0.2827    0.2856    0.2885    0.2914    0.2944    0.2973    0.3002

  Columns 111 through 121

    0.3031    0.3060    0.3089    0.3118    0.3148    0.3177    0.3206    0.3236    0.3265    0.3295    0.3324

  Columns 122 through 132

    0.3353    0.3383    0.3413    0.3442    0.3472    0.3501    0.3531    0.3561    0.3590    0.3620    0.3650

  Columns 133 through 143

    0.3680    0.3710    0.3740    0.3770    0.3799    0.3829    0.3859    0.3889    0.3920    0.3950    0.3980

  Columns 144 through 154

    0.4010    0.4040    0.4070    0.4101    0.4131    0.4161    0.4192    0.4222    0.4252    0.4283    0.4313

  Columns 155 through 165

    0.4344    0.4374    0.4405    0.4436    0.4466    0.4497    0.4528    0.4558    0.4589    0.4620    0.4651

  Columns 166 through 176

    0.4682    0.4713    0.4744    0.4774    0.4805    0.4836    0.4868    0.4899    0.4930    0.4961    0.4992

  Columns 177 through 187

    0.5023    0.5055    0.5086    0.5117    0.5149    0.5180    0.5211    0.5243    0.5274    0.5306    0.5337

  Columns 188 through 198

    0.5369    0.5401    0.5432    0.5464    0.5496    0.5527    0.5559    0.5591    0.5623    0.5655    0.5687

  Columns 199 through 209

    0.5719    0.5751    0.5783    0.5815    0.5847    0.5879    0.5911    0.5943    0.5975    0.6008    0.6040

  Columns 210 through 220

    0.6072    0.6105    0.6137    0.6169    0.6202    0.6234    0.6267    0.6299    0.6332    0.6365    0.6397

  Columns 221 through 231

    0.6430    0.6463    0.6495    0.6528    0.6561    0.6594    0.6627    0.6660    0.6693    0.6726    0.6759

  Columns 232 through 242

    0.6792    0.6825    0.6858    0.6891    0.6924    0.6958    0.6991    0.7024    0.7057    0.7091    0.7124

  Columns 243 through 253

    0.7158    0.7191    0.7225    0.7258    0.7292    0.7325    0.7359    0.7393    0.7427    0.7460    0.7494

  Columns 254 through 264

    0.7528    0.7562    0.7596    0.7630    0.7664    0.7698    0.7732    0.7766    0.7800    0.7834    0.7868

  Columns 265 through 275

    0.7902    0.7937    0.7971    0.8005    0.8040    0.8074    0.8109    0.8143    0.8178    0.8212    0.8247

  Columns 276 through 286

    0.8281    0.8316    0.8351    0.8385    0.8420    0.8455    0.8490    0.8525    0.8559    0.8594    0.8629

  Columns 287 through 297

    0.8664    0.8699    0.8735    0.8770    0.8805    0.8840    0.8875    0.8911    0.8946    0.8981    0.9017

  Columns 298 through 308

    0.9052    0.9087    0.9123    0.9159    0.9194    0.9230    0.9265    0.9301    0.9337    0.9372    0.9408

  Columns 309 through 319

    0.9444    0.9480    0.9516    0.9552    0.9588    0.9624    0.9660    0.9696    0.9732    0.9768    0.9804

  Columns 320 through 330

    0.9841    0.9877    0.9913    0.9950    0.9986    1.0022    1.0059    1.0095    1.0132    1.0169    1.0205

  Columns 331 through 341

    1.0242    1.0279    1.0315    1.0352    1.0389    1.0426    1.0463    1.0500    1.0536    1.0573    1.0611

  Columns 342 through 352

    1.0648    1.0685    1.0722    1.0759    1.0796    1.0834    1.0871    1.0908    1.0946    1.0983    1.1021

  Columns 353 through 363

    1.1058    1.1096    1.1133    1.1171    1.1209    1.1246    1.1284    1.1322    1.1360    1.1397    1.1435

  Columns 364 through 374

    1.1473    1.1511    1.1549    1.1587    1.1625    1.1664    1.1702    1.1740    1.1778    1.1817    1.1855

  Columns 375 through 385

    1.1893    1.1932    1.1970    1.2009    1.2047    1.2086    1.2124    1.2163    1.2202    1.2240    1.2279

  Columns 386 through 396

    1.2318    1.2357    1.2396    1.2435    1.2474    1.2513    1.2552    1.2591    1.2630    1.2669    1.2709

  Columns 397 through 407

    1.2748    1.2787    1.2826    1.2866    1.2905    1.2945    1.2984    1.3024    1.3063    1.3103    1.3143

  Columns 408 through 418

    1.3183    1.3222    1.3262    1.3302    1.3342    1.3382    1.3422    1.3462    1.3502    1.3542    1.3582

  Columns 419 through 429

    1.3622    1.3662    1.3703    1.3743    1.3783    1.3824    1.3864    1.3905    1.3945    1.3986    1.4026

  Columns 430 through 440

    1.4067    1.4108    1.4148    1.4189    1.4230    1.4271    1.4312    1.4353    1.4394    1.4435    1.4476

  Columns 441 through 451

    1.4517    1.4558    1.4599    1.4640    1.4682    1.4723    1.4764    1.4806    1.4847    1.4889    1.4930

  Columns 452 through 462

    1.4972    1.5014    1.5055    1.5097    1.5139    1.5181    1.5222    1.5264    1.5306    1.5348    1.5390

  Columns 463 through 473

    1.5432    1.5474    1.5517    1.5559    1.5601    1.5643    1.5686    1.5728    1.5770    1.5813    1.5855

  Columns 474 through 484

    1.5898    1.5940    1.5983    1.6026    1.6069    1.6111    1.6154    1.6197    1.6240    1.6283    1.6326

  Columns 485 through 495

    1.6369    1.6412    1.6455    1.6498    1.6542    1.6585    1.6628    1.6671    1.6715    1.6758    1.6802

  Columns 496 through 506

    1.6845    1.6889    1.6933    1.6976    1.7020    1.7064    1.7108    1.7151    1.7195    1.7239    1.7283

  Columns 507 through 517

    1.7327    1.7371    1.7415    1.7460    1.7504    1.7548    1.7592    1.7637    1.7681    1.7726    1.7770

  Columns 518 through 528

    1.7815    1.7859    1.7904    1.7949    1.7993    1.8038    1.8083    1.8128    1.8173    1.8218    1.8263

  Columns 529 through 539

    1.8308    1.8353    1.8398    1.8443    1.8489    1.8534    1.8579    1.8625    1.8670    1.8716    1.8761

  Columns 540 through 550

    1.8807    1.8852    1.8898    1.8944    1.8989    1.9035    1.9081    1.9127    1.9173    1.9219    1.9265

  Columns 551 through 561

    1.9311    1.9357    1.9404    1.9450    1.9496    1.9542    1.9589    1.9635    1.9682    1.9728    1.9775

  Columns 562 through 565

    1.9822    1.9868    1.9915    1.9962